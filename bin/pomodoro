#!/usr/bin/env node

var 
path     = require('path'),
version  = require('../package').version,

App = require('../src/pomodoro'),
OSNotifier = require('../src/OSNotifier'),
CliTimer = require('../src/CliTimer'),

chalk = require('chalk'),

dateFormat = require('dateformat')


var 
// app = new App(),
app = new App({task:0.5, shortBreak:.5}), //dev mode

now = function(){
  return dateFormat(new Date(), "h:MM:ss")
}


app.on('app.start', function(){
  console.log("\n")
  console.log(chalk.yellow('                      o       o '))
  console.log(chalk.yellow('                      |       | '))
  console.log(chalk.yellow('o-o  o-o o-O-o o-o   -o- \\ / -o-'))
  console.log(chalk.yellow('|  | | | | | | | |    |   o   | '))
  console.log(chalk.yellow('O-o  o-o o o o o-o O  o  / \\  o '))
  console.log(chalk.yellow('|                               '))
  console.log(chalk.yellow('o                               '))
  console.log("\n")
  console.log(chalk.green('* Starting a new Journey at ' + now() ))
})


app.on('task.start', function(time, task){
  console.log(
              chalk.cyan('===========================================================') + "\n"
              + '# Stating task ' + chalk.cyan(task) + ' at ' + chalk.cyan(now()) + "\n" +
              chalk.cyan('===========================================================') + "\n"
              )
})


app.on('task.timeover', function(){
  console.log(
    "\n\n" + chalk.gray('-------------------------- BREAK --------------------------') + "\n"
  )
})


app.on('shortBreak.timeover', function(){
  console.log(
    chalk.gray("\n\n................ END OF TASK @ " + now() + " ...................\n")
  )
})


var 
osNotifier = new OSNotifier(),
timer = new CliTimer()


timer.connect(app)
osNotifier.connect(app)


app.run()